<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Java8Stream(2)——如何使用Stream"><meta name="keywords" content="Java,Java8,Steram"><meta name="author" content="Lee"><meta name="copyright" content="Lee"><title>Java8Stream(2)——如何使用Stream | No Pain AnyMore</title><link rel="shortcut icon" href="http://ww1.sinaimg.cn/large/005yN1Nlgy1g0lee3rjxbj311s0scgpu.jpg"><link rel="stylesheet" href="/HexoBlog/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/HexoBlog/',
  algolia: {"appId":"W8TS0H8GFA","apiKey":"364d9cee251c8999b406cc3393f74a54","indexName":"hexo","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#collect"><span class="toc-number">1.</span> <span class="toc-text"> collect()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#filter"><span class="toc-number">2.</span> <span class="toc-text"> filter()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#map"><span class="toc-number">3.</span> <span class="toc-text"> map()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#maptoint-maptodouble-maptolong"><span class="toc-number">4.</span> <span class="toc-text"> mapToInt(), mapToDouble(), mapToLong()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#flatmap"><span class="toc-number">5.</span> <span class="toc-text"> flatMap()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#peek"><span class="toc-number">6.</span> <span class="toc-text"> peek()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#distinct"><span class="toc-number">7.</span> <span class="toc-text"> distinct()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sortedcomparator"><span class="toc-number">8.</span> <span class="toc-text"> sorted(comparator)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#limit"><span class="toc-number">9.</span> <span class="toc-text"> limit()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#其他api"><span class="toc-number">10.</span> <span class="toc-text"> 其他API</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料"><span class="toc-number">11.</span> <span class="toc-text"> 参考资料</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://ww1.sinaimg.cn/large/005yN1Nlgy1g0lee3rjxbj311s0scgpu.jpg"></div><div class="author-info__name text-center">Lee</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/Lee875083146">GitHub</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/HexoBlog/archives"><span class="pull-left">文章</span><span class="pull-right">20</span></a><a class="author-info-articles__tags article-meta" href="/HexoBlog/tags"><span class="pull-left">标签</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/HexoBlog/categories"><span class="pull-left">分类</span><span class="pull-right">23</span></a></div></div></div><div id="content-outer"><div class="plain" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/HexoBlog/">No Pain AnyMore</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/HexoBlog">主页</a><a class="site-page" href="/HexoBlog/archives">归档</a><a class="site-page" href="/HexoBlog/tags">标签</a><a class="site-page" href="/HexoBlog/categories">分类</a><a class="site-page" href="/HexoBlog/learningPlan">学习规划</a><a class="site-page" href="/HexoBlog/about">关于</a></span></div></div><div class="layout" id="content-inner"><article id="post"><div class="plain" id="post-title">Java8Stream(2)——如何使用Stream</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-17</time><span class="post-meta__separator">|</span><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/HexoBlog/categories/Java/"> Java</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/HexoBlog/categories/Java/Java8/"> Java8</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/HexoBlog/categories/Java/Java8/Stream/"> Stream</a></div><div class="article-container" id="post-content"><p>介绍常用的StreamAPI。<br>
本文中的例子GitHub地址：<a href="https://github.com/Lee875083146/java8/blob/master/src/main/java/com/nopainanymore/java8/Stream/StreamOperation.java" target="_blank" rel="noopener">https://github.com/Lee875083146/java8/blob/master/src/main/java/com/nopainanymore/java8/Stream/StreamOperation.java</a></p>
<a id="more"></a>
<p>例子中使用的类：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer stuId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer classId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, Integer age, String sex, Integer stuId, Integer classId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.stuId = stuId;</span><br><span class="line">        <span class="keyword">this</span>.classId = classId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="collect"><a class="markdownIt-Anchor" href="#collect"></a> collect()</h1>
<p>函数原型为<code>&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);</code>，使用<code>Collector</code>作为参数，一般使用<code>Collectors</code>类实现的各种收集操作，例如<code>toList</code>，<code>toSet</code>等。<code>Collectors</code>类中还实现了一些有意思的静态方法例如<code>groupingBy</code>,<code>partitioningBy</code>等。</p>
<h1 id="filter"><a class="markdownIt-Anchor" href="#filter"></a> filter()</h1>
<p>函数原型为<code>Stream&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate);</code>，其作用是返回满足<code>predicate</code>元素的Stream。<br>
例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">filter</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- filter- before :&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    List&lt;Student&gt; afterFilter = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .filter(student -&gt; MALE.equals(student.getSex()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- filter- after:&#123;&#125;"</span>, gson.toJson(afterFilter));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">23:55:33.560 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- filter- before :[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404&#125;]</span><br><span class="line">23:55:33.563 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- filter- after:[&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404&#125;]</span><br></pre></td></tr></table></figure>
<p>使用filter达到了将性别为女的学生过滤。</p>
<h1 id="map"><a class="markdownIt-Anchor" href="#map"></a> map()</h1>
<p>函数原型为<code>&lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);</code>，其作用返回当前所有元素执行mapper之后的结果组成的Stream。<br>
例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- map- before:&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    List&lt;String&gt; nameString = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .map(Student::getName)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- map- after:&#123;&#125;"</span>, gson.toJson(nameString));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">12:15:24.636 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- map- before:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404&#125;]</span><br><span class="line">12:15:24.641 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- map- after:[&quot;a1&quot;,&quot;a2&quot;,&quot;a3&quot;,&quot;a4&quot;]</span><br></pre></td></tr></table></figure>
<p>通过map获取到了所有学生的姓名</p>
<h1 id="maptoint-maptodouble-maptolong"><a class="markdownIt-Anchor" href="#maptoint-maptodouble-maptolong"></a> mapToInt(), mapToDouble(), mapToLong()</h1>
<p>三者的函数原型分别为<code>IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);</code>，<code>DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);</code>，<code>LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);</code>，分别返回<code>IntStream</code>、<code>DoubleStream</code>、<code>LongStream</code>三种基本类型流，基本类型流可以使用特殊的lambda表达式，同时支持一些聚合方法，如：<code>sum()</code>，<code>average()</code>等。<br>
例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mapToInt</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- mapToInt- before:&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    Double avgAge = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .mapToInt(Student::getAge)</span><br><span class="line">            .average()</span><br><span class="line">            .orElse(<span class="number">0</span>);</span><br><span class="line">    log.info(<span class="string">"StreamOperation- mapToInt- result:&#123;&#125;"</span>, avgAge);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">12:25:25.829 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- mapToInt- before:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404&#125;]</span><br><span class="line">12:25:25.833 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- mapToInt- result:20.5</span><br></pre></td></tr></table></figure>
<p>使用<code>mapToInte()</code>将<code>Student</code>流转化为年龄的<code>IntStream</code>，使用<code>average()</code> 获取<code>OptionalDouble</code>类型的结果，求出了学生的平均年龄.</p>
<h1 id="flatmap"><a class="markdownIt-Anchor" href="#flatmap"></a> flatMap()</h1>
<p>函数原型为<code>&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);</code>，<code>flatMap</code>可以将一个stream中的每一个元素对象转换为另一个stream中的另一种元素对象，因此可以将stream中的每个对象改造成零，一个或多个。flatMap操作的返回流包含这些改造后的对象。</p>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">flatMap</span><span class="params">(List&lt;List&lt;Student&gt;&gt; classList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- flatMap- before:&#123;&#125;"</span>, gson.toJson(classList));</span><br><span class="line">    List&lt;Student&gt; students = classList</span><br><span class="line">            .stream()</span><br><span class="line">            .flatMap(Collection::stream)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- flatMap- after:&#123;&#125;"</span>, gson.toJson(students));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">12:49:49.925 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- flatMap- before:[[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;],[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:2&#125;]]</span><br><span class="line">12:49:49.934 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- flatMap- after:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:2&#125;]</span><br></pre></td></tr></table></figure>
<p>通过<code>flatMap</code>将两个<code>List&lt;Student&gt;</code>组成的<code>classList</code>转化为一个<code>List&lt;Student&gt;</code>。</p>
<h1 id="peek"><a class="markdownIt-Anchor" href="#peek"></a> peek()</h1>
<p>函数原型<code>Stream&lt;T&gt; peek(Consumer&lt;? super T&gt; action);</code>，返回包含流中所有元素的流并为流中所以元素执行所提供的操作，该方法存在的目的是debug，可以用此方法</p>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">peek</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- peek- before:&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    Long numOfMale = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .peek(student -&gt; log.info(<span class="string">"first peek Student:&#123;&#125;"</span>, gson.toJson(student)))</span><br><span class="line">            .filter(student -&gt; MALE.equals(student.getSex()))</span><br><span class="line">            .peek(student -&gt; log.info(<span class="string">"second peek Student:&#123;&#125;"</span>, gson.toJson(student)))</span><br><span class="line">            .count();</span><br><span class="line">    log.info(<span class="string">"StreamOperation- peek- numOfMale:&#123;&#125;"</span>, numOfMale);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">19:45:58.814 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- peek- before:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;]</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - first peek Student:&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - first peek Student:&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - second peek Student:&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - first peek Student:&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - first peek Student:&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - second peek Student:&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;</span><br><span class="line">19:45:58.820 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- peek- numOfMale:2</span><br></pre></td></tr></table></figure>
<p>由日志打印出的信息我们也可以看到流构成的函数管道，将所有中间操作全部融合后执行。<br>
例子中也使用了<code>count()</code>来统计性别是男的学生人数。</p>
<h1 id="distinct"><a class="markdownIt-Anchor" href="#distinct"></a> distinct()</h1>
<p>函数原型<code>Stream&lt;T&gt; distinct();</code>，返回由该流中<code>equals</code>决定的唯一的元素组成的流，即用来去重。</p>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">distinct</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- distinct- before :&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    List&lt;Integer&gt; classIdList = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .map(Student::getClassId)</span><br><span class="line">            .distinct()</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- distinct- classIdList :&#123;&#125;"</span>, gson.toJson(classIdList));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">20:14:59.964 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- distinct- before :[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:2&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:2&#125;]</span><br><span class="line">20:14:59.974 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- distinct- classIdList :[1,2]</span><br></pre></td></tr></table></figure>
<p>通过<code>map</code>方法获取<code>classId</code>的集合，通过<code>distinct</code>去重获得不重复的班级。</p>
<h1 id="sortedcomparator"><a class="markdownIt-Anchor" href="#sortedcomparator"></a> sorted(comparator)</h1>
<p>函数原型<code>Stream&lt;T&gt; sorted(Comparator&lt;? super T&gt; comparator);</code>，返回一个由<code>comparator</code>决定的排序之后的流。</p>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sorted</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- sorted- before:&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    List&lt;Student&gt; sorted = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .sorted((o1, o2) -&gt; o2.getStuId() - o1.getStuId())</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- sorted- :&#123;&#125;"</span>, gson.toJson(sorted));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">20:38:52.395 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- sorted- before:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;]</span><br><span class="line">20:38:52.405 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- sorted- :[&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;]</span><br></pre></td></tr></table></figure>
<p>传入比较学号的lambda表达式，为了逆序用后一个学号减去前一个学号。</p>
<h1 id="limit"><a class="markdownIt-Anchor" href="#limit"></a> limit()</h1>
<p>函数原型<code>Stream&lt;T&gt; limit(long maxSize);</code>，截取流中前<code>maxSize</code>组成的元素组成新的流。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">limit</span><span class="params">(List&lt;Student&gt; studentList)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"StreamOperation- limit- before:&#123;&#125;"</span>, gson.toJson(studentList));</span><br><span class="line">    List&lt;Student&gt; limit = studentList</span><br><span class="line">            .stream()</span><br><span class="line">            .limit(<span class="number">2</span>)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    log.info(<span class="string">"StreamOperation- limit- after:&#123;&#125;"</span>, gson.toJson(limit));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">20:40:22.430 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- limit- before:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a3&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1403,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a4&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1404,&quot;classId&quot;:1&#125;]</span><br><span class="line">20:40:22.433 [main] INFO com.nopainanymore.java8.Stream.StreamOperation - StreamOperation- limit- after:[&#123;&quot;name&quot;:&quot;a1&quot;,&quot;age&quot;:21,&quot;sex&quot;:&quot;女&quot;,&quot;stuId&quot;:1401,&quot;classId&quot;:1&#125;,&#123;&quot;name&quot;:&quot;a2&quot;,&quot;age&quot;:20,&quot;sex&quot;:&quot;男&quot;,&quot;stuId&quot;:1402,&quot;classId&quot;:1&#125;]</span><br></pre></td></tr></table></figure>
<p>截取了前两个学生。</p>
<h1 id="其他api"><a class="markdownIt-Anchor" href="#其他api"></a> 其他API</h1>
<p>Stream中还有很多API在用到时，直接看源码及源码注释即可。</p>
<h1 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h1>
<p><a href="https://www.ibm.com/developerworks/cn/java/j-lo-java8streamapi/" target="_blank" rel="noopener">Java 8 中的 Streams API 详解</a><br>
<a href="https://www.jianshu.com/p/0c07597d8311" target="_blank" rel="noopener">Java 8 Stream 教程</a><br>
<a href="https://www.ibm.com/developerworks/cn/java/j-java8idioms11/index.html" target="_blank" rel="noopener">函数纯度</a><br>
<a href="https://colobu.com/2014/11/18/Java-8-Stream/" target="_blank" rel="noopener">Java 8 Stream探秘</a><br>
<a href="https://github.com/CarpenterLee/JavaLambdaInternals" target="_blank" rel="noopener">JavaLambdaInternals</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Lee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lee875083146.github.io/HexoBlog/2019/03/17/Java8Stream-2-——如何使用Stream/">https://lee875083146.github.io/HexoBlog/2019/03/17/Java8Stream-2-——如何使用Stream/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lee875083146.github.io/HexoBlog">No Pain AnyMore</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/HexoBlog/tags/Java/">Java</a><a class="post-meta__tags" href="/HexoBlog/tags/Java8/">Java8</a><a class="post-meta__tags" href="/HexoBlog/tags/Steram/">Steram</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/HexoBlog/2019/03/19/微服务设计读书笔记-3-——如何建模微服务/"><i class="fa fa-chevron-left">  </i><span>微服务设计读书笔记(3)——如何建模微服务</span></a></div><div class="next-post pull-right"><a href="/HexoBlog/2019/03/16/Java8Stream-1-——Stream介绍/"><span>Java8Stream(1)——Stream介绍</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2019 By Lee</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/HexoBlog/js/utils.js?version=1.6.1"></script><script src="/HexoBlog/js/fancybox.js?version=1.6.1"></script><script src="/HexoBlog/js/sidebar.js?version=1.6.1"></script><script src="/HexoBlog/js/copy.js?version=1.6.1"></script><script src="/HexoBlog/js/fireworks.js?version=1.6.1"></script><script src="/HexoBlog/js/transition.js?version=1.6.1"></script><script src="/HexoBlog/js/scroll.js?version=1.6.1"></script><script src="/HexoBlog/js/head.js?version=1.6.1"></script><script src="/HexoBlog/js/search/algolia.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>